{% load i18n %}
{% load md %}
<!DOCTYPE html>
<html lang="{{LANGUAGE_CODE}}">
<head>
	<title>{% block title %}bMa - Bouwmeester Ma√Ætre Architecte{% endblock %}</title>
	
	<link rel="stylesheet" href="{{STATIC_URL}}leaflet/dist/leaflet.css" />
	<link rel="stylesheet" href="{{STATIC_URL}}leaflet/dist/leaflet.ie.css" />
	<link rel="stylesheet" href="{{STATIC_URL}}javascript/lib/bootstrap/css/bootstrap.css" />
	<link rel="stylesheet/less" type="text/css" href="{{STATIC_URL}}styles.less">
	
	{% spaceless %}
	<script>
	if(!window.console){(function(){varnames=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"],i,l=names.length;window.console={};for(i=0;i<l;i++){window.console[names[i]]=function(){};}}());}

    // DATA
    window.bMa = {
        Style:{
            featureNormal:{
                stroke:true,
                color: '#d43b2d',
                weight:1,
                opacity:1,
                fill:true,
                fillColor: '#d43b2d',
                fillOpacity:0.75,
                clickable:true
            },
            featureHighlight:{
                stroke:true,
                color: '#d43b2d',
                weight:1,
                opacity:1,
                fill:true,
                fillColor: '#FF1600',
                fillOpacity:1,
                clickable:true
            },
        },
    };
    
    
    (function(undefined){
        'strict';
        window.bMa.Data = {
            Medias:{},
            Projects:{},
            Geometries:{},
            HotNews:[],
        };
        {% for cat in category %}
            {% if cat.pages %}
            window.bMa.Data.Medias['{{cat.name|escapejs}}'] = {};
            {% for page in cat.pages %}window.bMa.Data.Medias['{{cat.name|escapejs}}'][{{page.id}}] = {id:{{page.id}},title:'{{page.title|escapejs}}', slug:'{{page.slug}}'};{% endfor %}
            {% endif %}
        {% endfor %}
        
        {% for p in projects %} 
        window.bMa.Data.Projects['{{p.slug}}'] = {
            id:{{p.id}},
     {% if p.mpoly %}geometry:{{ p.mpoly.geojson|safe }},{% endif %}
     {% if p.mpoly %}city:'{{ p.city }}',{% endif %}
        }; 
        {% endfor %}
        
        {% for b in blog %}
        window.bMa.Data.HotNews.push({
            id:{{b.id}},
            slug:'{{b.slug}}',
            title:'{{b.title|escapejs}}',
            body:'{{ b.body|md|truncatewords_html:30|escapejs }}',
            pub_date : '{{b.pub_date}}',
            {% if b.image_url %}image_url :'{{b.image_url}}',{% endif %} 
        });
        {% endfor %}
    })();
    
	</script>
	{% endspaceless %}
</head>
<body>

<script src="{{STATIC_URL}}javascript/lib/less.js"></script>
<script src="{{STATIC_URL}}javascript/lib/jquery/jquery-1.9.1.min.js"></script>
<script src="{{STATIC_URL}}javascript/lib/leaflet/leaflet.js"></script>
<script src="{{STATIC_URL}}javascript/lib/underscore-min.js"></script>
<script src="{{STATIC_URL}}javascript/lib/backbone-min.js"></script>
<script src="{{STATIC_URL}}javascript/lib/template.js"></script>
<script src="{{STATIC_URL}}javascript/lib/bootstrap/js/bootstrap.min.js"></script>

<script src="{{STATIC_URL}}wms.config.js"></script>

<script src="{{STATIC_URL}}javascript/routers.js"></script>
<script src="{{STATIC_URL}}javascript/models.js"></script>
<script src="{{STATIC_URL}}javascript/collections.js"></script>
<script src="{{STATIC_URL}}javascript/views.js"></script>
<script src="{{STATIC_URL}}javascript/app.js"></script>
<script src="{{STATIC_URL}}javascript/index.js"></script>
</body>
</html>